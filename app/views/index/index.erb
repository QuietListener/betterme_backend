
<%= javascript_include_tag 'jquery.min' %>

<style>

.input-row{
  text-align: center;
  margin:4px;
  font-size: 16px;
}
.sinput_tip{
  font-size:12px;
}
.sinput
{
    border:1px solid #ccc;
    padding:4px;
    border-radius: 4px;
}

.submit-btn
{
  padding:4px;
  border-radius: 4px;
  border:1px solid red;
  color:red;
}


</style>

<div>
  <form>
    <div class="input-row">
      <span class="sinput_tip">手机号:</span>
      <input  id="phone1" placeholder="手机号" class="sinput" />
    </div>

    <div class="input-row">
      <span class="sinput_tip">密&nbsp&nbsp&nbsp码:</span>
      <input  id="password1" placeholder="密码" class="sinput" />
    </div>


    <div class="input-row" style="width:80%;text-align: center;margin:auto;margin-top: 10px;">
      <div class="submit-btn login-btn" style="margin:auto">注册</div>
    </div>

  </form>
</div>


<div>
  <form>
    <div class="input-row">
      <span class="sinput_tip">手机号:</span>
      <input id="phone2"  placeholder="手机号" class="sinput" />
    </div>

    <div class="input-row">
      <span class="sinput_tip">密&nbsp&nbsp&nbsp码:</span>
      <input id="password2"  placeholder="密码" class="sinput" />
    </div>



    <div class="input-row" style="margin-top: 10px">
      <input id="code" placeholder="验证码" class="sinput" style="width:90px"/> <span style="font-size:12px;padding:4px;border-radius:4px;background-color: #CCCCCC;color:white">获取验证码</span>
    </div>

    <div class="input-row" style="width:80%;text-align: center;margin:auto;margin-top: 10px;">
      <div class="submit-btn register-btn" style="margin:auto">注册</div>
    </div>
  </form>
</div>

<script>
  $(function(){
      $(".register-btn").on("click",function(){

          var data = {
              username:$("#phone2").val(),
              password:$("#password2").val(),
              code:$("#code").val()
          }

          //alert(JSON.stringify(data));

          //return;

          $.ajax({
              url:'register.json',
              type:'POST', //GET
              async:true,    //或false,是否异步
              data:data,
              timeout:5000,    //超时时间
              dataType:'json',    //返回的数据格式：json/xml/html/script/jsonp/text
              beforeSend:function(xhr){
                  console.log(xhr)
                  console.log('发送前')
              },
              success:function(data,textStatus,jqXHR){
                  console.log(data)
                  //错误
                  if(!data || data.status !=1 )
                  {
                      if(data.msg)
                      {
                          alert(data.msg);
                      }
                      else
                      {
                          alert("发生了未知错误");
                      }
                  }
                  else
                  {
                      window.location.href="http://<%=BUtils.domain+":3000/home"%>";
                  }


                  //成功；
                  //alert("成功")
              },
              error:function(data){
                alert("发生了错误未知错误");
              },
              complete:function(){
                  console.log('结束')
              }
          })
      });


      $(".login-btn").on("click",function(){

          var data = {
              username:$("#phone1").val(),
              password:$("#password1").val()
          }

          $.ajax({
              url:'login.json',
              type:'POST', //GET
              async:true,    //或false,是否异步
              data:data,
              timeout:5000,    //超时时间
              dataType:'json',    //返回的数据格式：json/xml/html/script/jsonp/text
              beforeSend:function(xhr){
                  console.log(xhr)
                  console.log('发送前')
              },
              success:function(data,textStatus,jqXHR){
                  console.log(data)
                  //错误
                  if(!data || data.status !=1 )
                  {
                      if(data.msg)
                      {
                          alert(data.msg);
                      }
                      else
                      {
                          alert("发生了未知错误");
                      }
                  }
                  else
                  {
                      window.location.href="http://<%=BUtils.domain+":3000/home"%>";
                  }

                  //成功；
                 // alert("成功")
              },
              error:function(data){
                  alert("发生了错误未知错误");
              },
              complete:function(){
                  console.log('结束')
              }
          })
      });
  })
</script>

